var u=async({userTableName:a,encryptTokenCallback:f,decryptTokenCallback:o,tokenTimeoutMin:r})=>({version:1,userTableName:a||"users",encryptTokenCallback:f||(async t=>{let e=new Date;return r&&(e.setMinutes(e.getMinutes()+r),t.tokenExpiredAt=e.getTime()),Buffer.from(JSON.stringify(t),"utf8").toString("hex")}),decryptTokenCallback:o||(async t=>{try{let c=Buffer.from(t,"hex").toString("utf8"),n=JSON.parse(c);return n.tokenExpiredAt&&new Date(n.tokenExpiredAt)>new Date?null:n}catch{return null}})}),k={getAuthentication:u};export{k as default};
